10 CLS

100 DIM GUNMAN$(4,3)
110 GUNMAN$(1,1) = " O"
120 GUNMAN$(1,2) = " |-+"
130 GUNMAN$(1,3) = "/ \"
140 GUNMAN$(2,1) = " O"
150 GUNMAN$(2,2) = " !"
160 GUNMAN$(2,3) = "/+\"
170 GUNMAN$(3,1) = "  O"
180 GUNMAN$(3,2) = "+-|"
190 GUNMAN$(3,3) = " / \"
200 GUNMAN$(4,1) = " O"
210 GUNMAN$(4,2) = " T"
220 GUNMAN$(4,3) = "/ \"

230 BLT$=CHR$(27)+"[2;31m*"
235 BLT$=BLT$+CHR$(27)+"[2;37m"
240 REACH=12

299 REM *** Game Loop ***
300 DIR=1:X=20:Y=10
310 GOSUB 1000
320 K=ISER(0)
325 PDIR=DIR
330 IF K=97 THEN X=X-2:DIR=3
340 IF K=100 THEN X=X+2:DIR=1
350 IF K=119 THEN Y=Y-1:DIR=4
360 IF K=115 THEN Y=Y+1:DIR=2
370 IF K=113 THEN 10000
380 IF K=32 THEN GOSUB 2000
390 IF PDIR=3 AND (DIR=2 OR DIR=4) THEN X=X+1
400 GOSUB 1200
410 GOTO 310

999 REM *** Draw Gunman! ***
1000 SCREEN X,Y
1010 PRINT GUNMAN$(DIR,1)
1020 SCREEN X,Y+1
1030 PRINT GUNMAN$(DIR,2)
1040 SCREEN X,Y+2
1050 PRINT GUNMAN$(DIR,3)
1060 RETURN

1199 REM *** Erase previous position ***
1200 IF DIR<>1 THEN 1300
1210 SCREEN X-2,Y:PRINT "   "
1220 SCREEN X-2,Y+1:PRINT "   "
1230 SCREEN X-2,Y+2:PRINT "  "
1300 IF DIR<>2 THEN 1400
1310 SCREEN X,Y-1:PRINT "   "
1320 SCREEN X+2,Y:PRINT " "
1320 SCREEN X-1,Y:PRINT " "
1325 SCREEN X+2,Y:PRINT "  "
1330 SCREEN X+2,Y+1:PRINT " "
1400 IF DIR<>3 THEN 1500
1410 SCREEN X+3,Y:PRINT "  "
1420 SCREEN X+3,Y+1:PRINT "    "
1430 SCREEN X+4,Y+2:PRINT "  "
1500 IF DIR<>4 THEN 1600
1510 SCREEN X+3,Y+2:PRINT " "
1520 SCREEN X-1,Y+2:PRINT " "
1530 SCREEN X,Y+3:PRINT "   "
1600 RETURN

1999 REM Shoot!
2000 IF DIR=1 THEN DX=1:DY=0:BX=X+4:BY=Y+1:SLP=20
2010 IF DIR=2 THEN DX=0:DY=1:BX=X+1:BY=Y+3:SLP=40
2020 IF DIR=3 THEN DX=-1:DY=0:BX=X-1:BY=Y+1:SLP=20
2030 IF DIR=4 THEN DX=0:DY=-1:BX=X+1:BY=Y-1:SLP=40
2034 RCH=REACH
2037 IF DIR=2 OR DIR=4 THEN RCH=REACH/2
2040 FOR d=1 to RCH
2045 REM COLOR 1,0
2050 SCREEN BX,BY:PRINT BLT$
2055 REM COLOR 7,0
2060 FOR w=1 to SLP:NEXT w
2070 SCREEN BX,BY:PRINT " "
2080 BX=BX+DX:BY=BY+DY
2085 IF BX<1 OR BY<1 THEN d=RCH
2090 NEXT d
2100 SCREEN BX,BY:PRINT " "
2200 RETURN


10000 END
RUN

